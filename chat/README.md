## Done
* динамическая очередь узлов сообщений
* динамический список узлов контекстов
* очередь узлов сообщений - общая для всех клиентов
* новому клиенту приходят сообщения, пришедшие после его ассепта
* даже, если отправка сообщений будет в несколько этапов оно удалится когда отправится всем получателям 

## Todo
* логировать работу сервера в файл (сейчас в консоль печатаю)
* в цикле чтение с клиента (в комментариях написал как делать)
* в цикле запись в клиента (в комментариях написал как делать)
* в цикле ассепт на серверном сокете (в комментариях написал как делать)
* вынести работу с каждой абстрацией в хедеры
* проследить чтобы в строке было не больше 80 символов, да и вообще си стайл соблюсти

## Алгоритм работы
Основной цикл:
* На событие коннекта нового клиента 
  * содаем узел контекст с контекстом
  * в контексте указатель на узел сообщения, которое должно быть отправлено этому клиенту, присвоить NULL
  * узел контекста добавляется в список узлов контекстов (в начало)
* На событие EPOLLRDHUP 
  * помечаем в контексте флажок -> удален
* На событие EPOLLOUT 
  * помечаем в контексте флажок -> можно писать
* На событие EPOLLIN:
  * прочитать посылку recv'ом, создать узел сообщения и сообщение, засунуть узел сообщения в очередь узлов сообщений (в конец)
  * пробежаться по списку узлов контекстов
    * если в контексте указатель на узел сообщение, которое должно быть послано этому клиенту сейчас == NULL, то присвоить ему указатель на только что созданный узел сообщения
    * пробежаться по очереди сообщений, начиная с узла, указатель на который хранится в этом контексте
      * инкрементировать в каждом счетчик receivers
* пробежаться по списку узлов контекстов
  * бежать по очереди узлов сообщений, начиная с узла, указатель на который хранится в этом контексте
    * если можно - отправляем сообщение
      * если send вернул -1 или EAGAIN то брейк из цикла
    * декрементировать счетчик  receivers этого сообщения
* рекурсивно удалить (начиная с головы до первого сообщения, которое удалять пока нельзя) узлы сообщений в очереди сообщений, счетчик receivers которых == 0
* пробежаться по списку контекстов
  * удалить те, которые помечены для удаления
